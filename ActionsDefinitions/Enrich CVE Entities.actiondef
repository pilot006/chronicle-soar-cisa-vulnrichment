{"Name":"Enrich CVE Entities","Description":"","Script":"from SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import unix_now, convert_unixtime_to_datetime, output_handler\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\nimport requests\n\n\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    for entity in siemplify.target_entities:\n        if entity.identifier[:3] == 'CVE':\n            cve = entity.identifier\n            siemplify.LOGGER.info('Found CVE: ' + cve)\n            cve_chunk = cve.split('-')\n            if(len(cve_chunk[2]) == 5):\n                cid = cve_chunk[2][:2]\n            else:\n                cid = cve_chunk[2][:1]\n            url = 'https://raw.githubusercontent.com/cisagov/vulnrichment/develop/' + cve_chunk[1]\n            url = url + '/' + cid + 'xxx/' + cve + '.json'\n\n            req = requests.get(url)\n            if(req.status_code==200):\n                result_value = \"CVE Found\"\n                siemplify.result.add_result_json(req.text)\n            else:\n                result_value = \"CVE Not Found\"\n\n            siemplify.LOGGER.info(req.text)\n\n    status = EXECUTION_STATE_COMPLETED\n    output_message = result_value\n\n\n    siemplify.LOGGER.info(\"\\n  status: {}\\n  result_value: {}\\n  output_message: {}\".format(status,result_value, output_message))\n    siemplify.end(output_message, result_value, status)\n\n\nif __name__ == \"__main__\":\n    main()","IntegrationIdentifier":"CISA Vulnrichment","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{}","ShowResult":false}],"Creator":"036fe879-4c16-461e-b6d9-b1c552806fa0","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":3.0,"TimeoutSeconds":600,"IsAsync":false,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[],"DefaultResultValue":"","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}